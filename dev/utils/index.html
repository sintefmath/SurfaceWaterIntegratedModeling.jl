<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utilities and visualization · SWIM</title><meta name="title" content="Utilities and visualization · SWIM"/><meta property="og:title" content="Utilities and visualization · SWIM"/><meta property="twitter:title" content="Utilities and visualization · SWIM"/><meta name="description" content="Documentation for SWIM."/><meta property="og:description" content="Documentation for SWIM."/><meta property="twitter:description" content="Documentation for SWIM."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SWIM logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SWIM</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../urban/">Urban landscape</a></li><li><a class="tocitem" href="../synthetic/">Simple synthetic example</a></li><li><a class="tocitem" href="../flat_areas/">Handling flat areas</a></li></ul></li><li><a class="tocitem" href="../static/">Static analysis</a></li><li><a class="tocitem" href="../dynamic/">Dynamic analysis</a></li><li class="is-active"><a class="tocitem" href>Utilities and visualization</a></li><li><a class="tocitem" href="../indexlist/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Utilities and visualization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Utilities and visualization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/main/docs/src/utils.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Utilities-and-visualization"><a class="docs-heading-anchor" href="#Utilities-and-visualization">Utilities and visualization</a><a id="Utilities-and-visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities-and-visualization" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.saturated_spillgraph-Tuple{TrapStructure}" href="#SurfaceWaterIntegratedModeling.saturated_spillgraph-Tuple{TrapStructure}"><code>SurfaceWaterIntegratedModeling.saturated_spillgraph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturated_spillgraph(tstruct)</code></pre><p>Create the spillgraph corresponding to the provided trapping structure, considering that all traps are already filled.</p><p>The result will be returned as a <code>SimpleDiGraph</code> showing which traps are spilling into which traps or regions.  </p><p>The trapping structure <code>tstruct</code> may have regions with negative indices (referring to regions that spill out of the terrain).  Since <code>SimpleDiGraph</code> does not handle nodes with negative indices, a remapping is necessary between the indices used in <code>tstruct</code> and the set 1:N used in the returned graph. These mappings are returned as the second and third return value:</p><ul><li>The second return value is a <code>Vector{Int}</code> mapping from 1:N to the indices  in <code>tstruct</code></li><li>The third return value is a <code>Dict</code> mapping from the indices in <code>tstruct</code> to  1:N.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/watercourses.jl#L118-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.watercourses-Tuple{TrapStructure, Vector{Bool}}" href="#SurfaceWaterIntegratedModeling.watercourses-Tuple{TrapStructure, Vector{Bool}}"><code>SurfaceWaterIntegratedModeling.watercourses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">watercourses(tstruct, full_traps, precipitation, infiltration)</code></pre><p>Compute the total intensity of flow of water across all non-lake grid cells in the terrain.</p><p>Determine the areas containing high amounts of flowing water, and return a grid with the corresponding values.</p><p><strong>Arguments</strong></p><ul><li><code>tstruct::TrapStructure</code>: a TrapStructure object containing all the information from                            the topographical analysis, as returned by the                           <code>spillanalysis</code> function.</li><li><code>full_traps::Vector{Bool}</code>: A vector with one entry per (sub)trap, indicating                              whether this trap has been filled yet or not.  Only full                             traps will overflow and forward the water from upstream.</li><li><code>precipitation::Matrix{&lt;:Real}</code>: A grid expressing precipitation rate per grid cell.                                   If left empty, it will be substituted by a grid                                    filled with ones.</li><li><code>infiltration::Matrix{&lt;:Real}</code>: A grid expressing the maximum infiltration rate                                  per grid cell.  If left empty, it will be substituted                                 by a grid filled with zeros.</li></ul><p><strong>Returns</strong></p><ul><li><code>runoff::Matrix{Float64}</code>: Grid expressing infiltration excess runoff rate                             (positive values)                             or remaining infiltration capacity (negative values)</li><li><code>region_accum::Vector{Float64}</code>: Vector with one entry per spill region, indicating                         net water accumulation rate for that region (also including                         water spilling into the region from upstream filled traps).                          Note that if the region is associated with a filled trap,                          the accumulation value is set to zero, unless it spills into                         a filled &#39;sibling&#39; trap.  The logic is in any case such that                          the accumulation of any still unfilled trap should equal                         the sum of accumulation of its regions.</li><li><code>offregion_runoff::Float64</code>: Total rate of water flowing off the domain</li><li><code>used_infiltration::Float64</code>: Total infiltration rate across the terrain</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/watercourses.jl#L5-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.all_subtraps_of-Tuple{Graphs.SimpleGraphs.SimpleDiGraph, Union{Int64, Vector{Int64}}}" href="#SurfaceWaterIntegratedModeling.all_subtraps_of-Tuple{Graphs.SimpleGraphs.SimpleDiGraph, Union{Int64, Vector{Int64}}}"><code>SurfaceWaterIntegratedModeling.all_subtraps_of</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">all_subtraps_of(subtrap_graph, trap_ixs)</code></pre><p>Return all subtraps (at any level) of a specified set of traps.</p><p>The graph representing the supertrap/subtrap tree is given by <code>subtrap_graph</code>.  The indices to the set of traps is specified by <code>trap_ixs</code>.  This argument may be an integer refering to a single trap, or a <code>Vector{Int}</code> referring to  one or more traps.</p><p>The result is returned as a <code>Vector{Int}</code> giving the indices of all traps that  are subtraps of the trap(s) referred to by <code>trap_ixs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L456-L468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.all_upstream_regions-Tuple{TrapStructure, Int64}" href="#SurfaceWaterIntegratedModeling.all_upstream_regions-Tuple{TrapStructure, Int64}"><code>SurfaceWaterIntegratedModeling.all_upstream_regions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">all_upstream_regions(tstruct, region)</code></pre><p>Identify all spill regions that will eventually become part of the extended watershed of a specified region.</p><p>When traps are empty, water accumulates locally.  As traps fill up, water starts to spill from upstream to downstream regions.  This function identifies all the spill regions that will flow into a specified region/trap when all upstream traps have been completely filled.</p><p>The result is returned as a <code>Vector{Int}</code>, giving the indices of all regions  that will be upstream of the specified region when all traps are filled.</p><p><strong>Arguments</strong></p><ul><li><code>tstruct::TrapStructure{&lt;:Real}</code>: trap structure object describing the terrain traps</li><li><code>region::Int</code>: index of the region in question</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.upstream_area-Tuple{TrapStructure, Int64}"><code>upstream_area</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L696-L715">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.compute_spillfield_graph-Tuple{Matrix{Int8}}" href="#SurfaceWaterIntegratedModeling.compute_spillfield_graph-Tuple{Matrix{Int8}}"><code>SurfaceWaterIntegratedModeling.compute_spillfield_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_spillfield_graph(spillfield::Matrix{Int8})</code></pre><p>Compute a Graphs.SimpleDiGraph representation from a spillfield matrix.</p><p>The <code>spillfield</code> variable is a matrix that can be generated by the  <a href="../static/#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L732-L739">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.flatten_grid!-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Bool}, Symbol}" href="#SurfaceWaterIntegratedModeling.flatten_grid!-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Bool}, Symbol}"><code>SurfaceWaterIntegratedModeling.flatten_grid!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flatten_grid!(grid::Matrix{&lt;:Real}, mask::Matrix{&lt;:Bool}, height_choice::Symbol)</code></pre><p>Flatten indicated areas of a terrain grid.</p><p>The grid <code>grid</code> represents height values of a terrain, and will be modified by the function.  The <code>mask</code> is a similarly sized, boolean grid that identifies which areas should be flattened (all cells with value <code>true</code>).  Each such connected region is then assigned a fixed height value and <code>grid</code> is modified accordingly.  </p><p>There are three ways of computing the height, indicated by the <code>height_choice</code> argument.  Valid options are:</p><ul><li><code>:min</code> - the height of each flat area becomes the minimum value of its grid cells</li><li><code>:max</code> - the height of each flat area becomes the  maximum value of its grid cells</li><li><code>:mean</code> - the height of each flat area becomes the mean value of its grid cells</li></ul><p>See also: <a href="#SurfaceWaterIntegratedModeling.identify_flat_areas"><code>identify_flat_areas</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L288-L308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.identify_flat_areas" href="#SurfaceWaterIntegratedModeling.identify_flat_areas"><code>SurfaceWaterIntegratedModeling.identify_flat_areas</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">identify_flat_areas(grid, rel_tol, min_cluster_size, lengths=nothing)</code></pre><p>Identify areas in the grid that are flat within a specified tolerance.  Can be used to detect lakes in a terrain.</p><p>Returns a boolean grid of same shape as the input grid, where cells that are  considered to belong to flat areas are flagged as &#39;true&#39; (rest are false).</p><p><strong>Arguments</strong></p><ul><li><code>grid::Matrix{&lt;:Real}</code>: terrain raster grid with height values</li><li><code>rel_tol::Real</code>: tolerance to use in determine when a slope between two grid                  cells may be considered &#39;flat&#39;.  The tolerance is specified                  relatively to the maximum slope present in the grid.</li><li><code>min_cluster_size::Int</code>: Specify how large an agglomeration of &quot;flat&quot; cells                          needs to be (in terms of number of cells) in order                           to be included in the result.  This is used to                           filter out small fragments that are not considered                           important.</li><li><code>lengths::Tuple{Int, Int}</code>: Specify the length of the grid in x and y                             directions.  This is needed to correctly handle                            the aspect ratio when computing slopes.  If no                             argument provided, the resolution of the grid                             is used as a substitute.</li></ul><p>See also: <a href="#SurfaceWaterIntegratedModeling.flatten_grid!-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Bool}, Symbol}"><code>flatten_grid!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L348-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.interpolate_timeseries-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.interpolate_timeseries-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.interpolate_timeseries</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_timeseries(tstruct, seq, timepoints; 
                       filled_color=1, trap_color=2, river_color=3)</code></pre><p>Compute the exact terrain fill states for a sequence of timepoints, given a trapping structure and sequence of <code>SpillEvent</code>s.</p><p>Each generated fill state is represented as an integer matrix (<code>Matrix{Int}</code>), where submerged cells are set to <code>filled_color</code>, the parts of traps that are not (yet) submerged set to <code>trap_color</code> and intermittent streams set to <code>river_color</code>.  Other cells are attributed the value zero.</p><p>The result is returned as a <code>Vector{Matrix{Int}}</code>, of the same length as <code>timepoints</code>.  A second return value provides a corresponding <code>Vector{Int}</code> that for each timepoint provides the index for the latest preceding event in <code>seq</code>.</p><p><strong>Arguments</strong></p><ul><li><code>tstruct::TrapStructure{&lt;:Real}</code>: trap structure object describing the terrain traps</li><li><code>seq::Vector{SpillEvent}</code>: the sequence of events, as computed by                             <a href="../dynamic/#SurfaceWaterIntegratedModeling.fill_sequence-Tuple{TrapStructure, Vector{WeatherEvent}}"><code>fill_sequence</code></a> for a given weather scenario</li><li><code>timepoints::Vector{&lt;:Real}</code>: the timepoints for which we want to compute the exact                               terrain fill states.  Should be given in ascending                               order.</li><li><code>filled_color::Int</code>: The &#39;color&#39; value to represent filled areas (default: 1).</li><li><code>trap_color::Int</code>: The &#39;color&#39; to represent unfilled parts of traps (default: 2).</li><li><code>river_color::Int</code>: The &#39;color&#39; to represent intermittent rivers (default: 3).</li><li><code>verbose::Bool</code>: Whether to print progess information during computations (default: true).</li></ul><p>See also <a href="../static/#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a>, <a href="../dynamic/#SurfaceWaterIntegratedModeling.fill_sequence-Tuple{TrapStructure, Vector{WeatherEvent}}"><code>fill_sequence</code></a>,  <a href="#SurfaceWaterIntegratedModeling.trap_states_at_timepoints-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}"><code>trap_states_at_timepoints</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L10-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.show_region_selection-Tuple{TrapStructure}" href="#SurfaceWaterIntegratedModeling.show_region_selection-Tuple{TrapStructure}"><code>SurfaceWaterIntegratedModeling.show_region_selection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">show_region_selection(tstruct; selection=nothing, 
                      region_color=1, trap_color=2, river_color=3)</code></pre><p>Create a texture identifying the requested regions, traps and related rivers.</p><p>The information about the terrain, including topography, spillpoints, etc., is provided by the structure <code>tstruct</code>, which can be obtained from the <a href="../static/#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a> function.  The selected regions are identified by <code>selection</code>, a vector with the indices of the selected regions.  If left empty, all toplevel traps/regions will be selected.  </p><p>The result is returned as a matrix of integers, where the integers can be thought of as &#39;colors&#39;. The integer values used to indicate region, trap or river are given by the arguments <code>region_color</code>, <code>trap_color</code> and <code>river_color</code>, respectively.  If <code>region_color</code> is a negative integer, each region will be assigned an unique color, starting from <code>abs(region_color)</code> and incrementing by one per region.</p><p><strong>Arguments</strong></p><ul><li><code>selection</code>: integer vector containing indices of the selected regions</li><li><code>region_color</code>: integer to assign to the cells of all selected regions</li><li><code>trap_color</code>: integer to assign to all selected traps </li><li><code>river_color</code>: integer to assign to all river cells related to the selected                regions</li></ul><p>See also: <a href="../static/#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L487-L514">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.toplevel_traps-Tuple{Graphs.SimpleGraphs.SimpleDiGraph}" href="#SurfaceWaterIntegratedModeling.toplevel_traps-Tuple{Graphs.SimpleGraphs.SimpleDiGraph}"><code>SurfaceWaterIntegratedModeling.toplevel_traps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">toplevel_traps(subtrap_graph)</code></pre><p>Identify all top-level traps in the given subtrap graph.</p><p>Top-level traps are those that those that are not subtraps of yet larger lakes. The result is returned as a vector of indices to those traps.</p><p><strong>Arguments</strong></p><ul><li><code>subtrap_graph::Graphs.SimpleDiGraph</code>: oriented graph expressing the trap/subtrap                                         graph structure.  If A is a subtrap of B, there                                         will be an edge pointing from A to B.  As such,                                         the toplevel traps are those with not outwards-                                        pointing edges.</li></ul><p>See also: <a href="../static/#SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}"><code>sshierarchy!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L429-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.trap_states_at_timepoints-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.trap_states_at_timepoints-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.trap_states_at_timepoints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trap_states_at_timepoints(tstruct, seq, timepoints)</code></pre><p>Compute the exact amount of water in all traps for a specific set of timepoints, given a trapping structure and sequence of <code>SpillEvent</code>s.</p><p>The result is returned as a vector of three-element tuples, with one entry per timepoint.  </p><ul><li>The first element of the tuple is a <code>Vector{Bool}</code> with one entry per trap, indicating if the trap is filled or not at the specified timepoint.</li><li>The second element is a <code>Vector{Real}</code> with one entry per trap, giving the  amount of water in that trap at the specified timepoint.</li><li>The third element is an index into <code>seq</code>, pointing to the last <code>SpillEvent</code> to occur before the timepoint.</li></ul><p><strong>Arguments</strong></p><ul><li><code>tstruct::TrapStructure{&lt;:Real}</code>: trap structure object describing the terrain traps</li><li><code>seq::Vector{SpillEvent}</code>: the sequence of events, as computed by                             <a href="../dynamic/#SurfaceWaterIntegratedModeling.fill_sequence-Tuple{TrapStructure, Vector{WeatherEvent}}"><code>fill_sequence</code></a> for a given weather scenario</li><li><code>timepoints::Vector{&lt;:Real}</code>: the timepoints for which we want to compute the exact                               water amounts of the traps.  Should be given in                                ascending order.</li><li><code>verbose::Bool</code>: Whether to print progess information during computations (default: true).</li></ul><p>See also <a href="../static/#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a>, <a href="../dynamic/#SurfaceWaterIntegratedModeling.fill_sequence-Tuple{TrapStructure, Vector{WeatherEvent}}"><code>fill_sequence</code></a>,  <a href="#SurfaceWaterIntegratedModeling.interpolate_timeseries-Tuple{TrapStructure, Vector{SpillEvent}, Vector{&lt;:Real}}"><code>interpolate_timeseries</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L69-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.upstream_area-Tuple{TrapStructure, Int64}" href="#SurfaceWaterIntegratedModeling.upstream_area-Tuple{TrapStructure, Int64}"><code>SurfaceWaterIntegratedModeling.upstream_area</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upstream_area(tstruct, point, local_only=true)</code></pre><p>Determine all grid cells belonging to the upstream area of a given point location in the terrain grid.</p><p>Result is returned as a <code>Vector{Int}</code>, giving the linear indices of the terrain  grid cells that constitute the upstream area of the specified point.</p><p><strong>Arguments</strong></p><ul><li><code>tstruct::TrapStructure{&lt;:Real}</code>: trap structure object describing the terrain traps</li><li><code>point::Int</code>: linear index to the terrain grid cell for which the upstream area               is requested</li><li><code>local_only::Bool</code>: if true, consider only the immediate spill region.  If                      otherwise, consider also upstream spill regions.</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.all_upstream_regions-Tuple{TrapStructure, Int64}"><code>all_upstream_regions</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/utils.jl#L620-L637">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.drape_surface-Tuple{Any, Any}" href="#SurfaceWaterIntegratedModeling.drape_surface-Tuple{Any, Any}"><code>SurfaceWaterIntegratedModeling.drape_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drape_surface(surf, tex)</code></pre><p>Update the texture of a surface drawn with <a href="#SurfaceWaterIntegratedModeling.plotgrid-Tuple{AbstractMatrix{&lt;:Real}}"><code>plotgrid</code></a>. Here, <code>surf</code> is a mesh object (first return value of <a href="#SurfaceWaterIntegratedModeling.plotgrid-Tuple{AbstractMatrix{&lt;:Real}}"><code>plotgrid</code></a>,  whereas <code>tex</code> can be a matrix of numbers or of <code>Colorant</code> (see <code>plotgrid</code>  documentation for specifics).</p><p>See also <a href="#SurfaceWaterIntegratedModeling.plotgrid-Tuple{AbstractMatrix{&lt;:Real}}"><code>plotgrid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/IOandplot.jl#L193-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.loadgrid-Tuple{String}" href="#SurfaceWaterIntegratedModeling.loadgrid-Tuple{String}"><code>SurfaceWaterIntegratedModeling.loadgrid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loadgrid(filename, delimiter)</code></pre><p>Load a 2D grid saved in csv format, with a specified delimiter separating  individual entries.  Returns a Matrix{Real}.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/IOandplot.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.plotgrid-Tuple{AbstractMatrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.plotgrid-Tuple{AbstractMatrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.plotgrid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plotgrid(grid, texture=nothing, colormap=:lightrainbow, wireframe=false, 
         downsamplefac=1, heightfac=1, colorrange=nothing)</code></pre><p>Plot a texture-mapped 2½D surface of a given grid, using Makie.</p><p>The function returns three values in the following order: </p><ul><li>the surface object</li><li>the figure</li><li>the scene</li></ul><p><strong>Arguments</strong></p><ul><li><code>grid::AbstractArray{&lt;:Real, 2}</code>: 2D array representing the grid</li><li><code>texture::Union{Matrix{&lt;:Union{Real, Colorant}}, Nothing}</code>:     optional texture for the grid.  This can be presented as a matrix of    Colorant (directly representing colors), or of numbers (in which case the    prevailing <code>colormap</code> and <code>colorrange</code> are used to specify the actual    colors).  If <code>texture</code> is left to <code>nothing</code>, the height values of <code>grid</code>     will be directly used as a substitute.</li><li><code>colormap::Union{Symbol, ColorScheme}=:lightrainbow</code>:     specifies the colormap to use if the texture is provided as a matrix     of numbers.  It can either be a symbol referring to a specific colormap    used by Makie (call <code>Makie.available_gradients()</code> for a list of available    colormap symbols), or directly provided as a <code>ColorScheme</code>.  Note that     if <code>texture</code> is given as a <code>Matrix{Colorant}</code>, then <code>colormap</code> has no     effect.</li><li><code>wireframe::Bool</code>: option to display wireframe grid</li><li><code>downsamplefac::Real</code>: scaling factor for downsampling the grid. Useful for                        rapid visualization of very large grids.</li><li><code>heightfac::Real</code>: Scaling factor for height values of the grid</li><li><code>colorrange::Tuple{&lt;:Real, &lt;:Real}</code>: specify the values representing the start                                      and end points of <code>colormap</code></li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.drape_surface-Tuple{Any, Any}"><code>drape_surface</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/IOandplot.jl#L40-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.savegrid-Tuple{String, Any}" href="#SurfaceWaterIntegratedModeling.savegrid-Tuple{String, Any}"><code>SurfaceWaterIntegratedModeling.savegrid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">savegrid(filename, matrix, delimiter)</code></pre><p>Save the 2D grid represented by <code>matrix</code> to the csv file with name <code>filename</code>,  using a specified character as delimiter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/IOandplot.jl#L25-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.set_camerapos-NTuple{5, Any}" href="#SurfaceWaterIntegratedModeling.set_camerapos-NTuple{5, Any}"><code>SurfaceWaterIntegratedModeling.set_camerapos</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>set_camerapos(figure, scene, cpos, ctarget, czoom)</p><p>Set the camera position, target and zoom level for a given scene.</p><p>This function is provided as a workaround to smooth over different idiosyncracies in camera handling for the Makie backends GLMakie and  CairoMakie.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/494d755e905d20bc97b443b6f0f7217c85adc1da/src/IOandplot.jl#L208-L216">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dynamic/">« Dynamic analysis</a><a class="docs-footer-nextpage" href="../indexlist/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 27 December 2024 17:26">Friday 27 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
