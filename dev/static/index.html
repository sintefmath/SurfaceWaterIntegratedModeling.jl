<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Static analysis · Surface Water Integrated Modeling</title><meta name="title" content="Static analysis · Surface Water Integrated Modeling"/><meta property="og:title" content="Static analysis · Surface Water Integrated Modeling"/><meta property="twitter:title" content="Static analysis · Surface Water Integrated Modeling"/><meta name="description" content="Documentation for Surface Water Integrated Modeling."/><meta property="og:description" content="Documentation for Surface Water Integrated Modeling."/><meta property="twitter:description" content="Documentation for Surface Water Integrated Modeling."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Surface Water Integrated Modeling logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Surface Water Integrated Modeling</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../urban/">Urban landscape</a></li><li><a class="tocitem" href="../synthetic/">Simple synthetic example</a></li><li><a class="tocitem" href="../flat_areas/">Handling flat areas</a></li></ul></li><li class="is-active"><a class="tocitem" href>Static analysis</a><ul class="internal"><li><a class="tocitem" href="#TrapStructure"><span>TrapStructure</span></a></li><li><a class="tocitem" href="#Spill-analysis"><span>Spill analysis</span></a></li><li><a class="tocitem" href="#Lower-level-functions"><span>Lower-level functions</span></a></li></ul></li><li><a class="tocitem" href="../dynamic/">Dynamic analysis</a></li><li><a class="tocitem" href="../utils/">Utilities and visualization</a></li><li><a class="tocitem" href="../indexlist/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Static analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Static analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/main/docs/src/static.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Static-topographic-analysis"><a class="docs-heading-anchor" href="#Static-topographic-analysis">Static topographic analysis</a><a id="Static-topographic-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Static-topographic-analysis" title="Permalink"></a></h1><p>This page contains the documentation of the main functions related to the static analysis.</p><h2 id="TrapStructure"><a class="docs-heading-anchor" href="#TrapStructure">TrapStructure</a><a id="TrapStructure-1"></a><a class="docs-heading-anchor-permalink" href="#TrapStructure" title="Permalink"></a></h2><p>The <code>TrapStructure</code> contains all the fundamental results from running <a href="#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a>.  This includes the identified traps, their volumes, footprints, how they are connected, and the associated watersheds and spill point locations. <code>TrapStructure</code> also contains the <em>spillfield</em> (how flow is directed between gridcells), as well as a copy of the topography, buildings and sinks that went into the analysis.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.TrapStructure" href="#SurfaceWaterIntegratedModeling.TrapStructure"><code>SurfaceWaterIntegratedModeling.TrapStructure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TrapStructure{T&lt;:Real}</code></pre><p>A struct representing a watershed drainage trap for topographical analysis.</p><p><strong>Fieldnames</strong></p><ul><li><code>topography::Matrix{T}</code>: raster grid of terrain height values.</li><li><code>spillfield::Matrix{Int8}</code>: local direction of streamline (see <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>)</li><li><code>regions::Matrix{Int}</code>: raster grid with region numbers (see <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a>)</li><li><code>spillpoints::Vector{Spillpoint}</code>: vector with spill point information per trap                                    (see <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a>)</li><li><code>trapvolumes::Vector{T}</code>: computed trap volumes (see <a href="#SurfaceWaterIntegratedModeling.trapvolumes-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector{Spillpoint}, Vector{Vector{Int64}}}"><code>trapvolumes</code></a>)</li><li><code>subvolumes::Vector{T}</code>: the part of each trap&#39;s volume that is fully contained within                          its subtraps</li><li><code>footprints::Vector{Vector{Int}}</code>: one entry per trap, listing the (linear) indices                                    of all its cells </li><li><code>lowest_subtraps_for::Vector{Vector{Int}}</code>: one entry per trap, listing all its                                             lowest-level subtraps</li><li><code>supertraps_of::Vector{Vector{Int}}</code>: one entry per lowest-level trap, listing all                                       the supertraps it belongs to (including itself).</li><li><code>agglomerations::Graphs.SimpleDiGraph</code>: hierarchy of sub/supertraps, presented as a                                         graph structure</li><li><code>building_mask::Union{Matrix{Bool}, Nothing}</code>: building mask (0: terrain, 1: building)</li><li><code>sinks::Union{Vector{Tuple{Int, Int}}, Nothing}</code>: list of sinks, in term of grid                                                   cell coordinates</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/TrapStructure.jl#L6-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.numregions-Tuple{TrapStructure}" href="#SurfaceWaterIntegratedModeling.numregions-Tuple{TrapStructure}"><code>SurfaceWaterIntegratedModeling.numregions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">numregions(tstruct)</code></pre><p>Returns the number of regions identified in the <a href="#TrapStructure"><code>TrapStructure</code></a> <code>tstruct</code>. The number of regions is identical to the number of lowest-level traps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/TrapStructure.jl#L55-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.numtraps-Tuple{TrapStructure}" href="#SurfaceWaterIntegratedModeling.numtraps-Tuple{TrapStructure}"><code>SurfaceWaterIntegratedModeling.numtraps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">numtraps(tstruct)</code></pre><p>Returns the number of traps identified in the <a href="#TrapStructure"><code>TrapStructure</code></a> <code>tstruct</code>. This includes the lowest-level traps as well as all higher-level traps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/TrapStructure.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.parentof-Tuple{TrapStructure, Int64}" href="#SurfaceWaterIntegratedModeling.parentof-Tuple{TrapStructure, Int64}"><code>SurfaceWaterIntegratedModeling.parentof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parentof(tstruct, trap_ix)</code></pre><p>Given a <a href="#TrapStructure"><code>TrapStructure</code></a> tstruct, returns the index of the parent trap (immediate higher-level trap) of the trap indexed <code>trap_ix</code>.  If this trap does  not have a parent trap, nothing is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/TrapStructure.jl#L92-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.subtrapsof-Tuple{TrapStructure, Int64}" href="#SurfaceWaterIntegratedModeling.subtrapsof-Tuple{TrapStructure, Int64}"><code>SurfaceWaterIntegratedModeling.subtrapsof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subtrapsof(tstruct, trap_ix)</code></pre><p>Given a <a href="#TrapStructure"><code>TrapStructure</code></a> tstruct, returns the indices to the immediate subtraps of the trap indexed <code>trap_ix</code>. This is usually zero or two, but can be higher than two in degenerate cases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/TrapStructure.jl#L80-L86">source</a></section></article><h2 id="Spill-analysis"><a class="docs-heading-anchor" href="#Spill-analysis">Spill analysis</a><a id="Spill-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Spill-analysis" title="Permalink"></a></h2><p>The function <code>spillanalysis</code> runs a complete analysis on a provided terrain grid and associated buildings and sinks, and returns a <a href="#TrapStructure"><code>TrapStructure</code></a> as output.  This is the central function for static topographic analysis in SWIM.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.spillanalysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spillanalysis(grid, usediags=true, building_mask=nothing, sinks=nothing,
              lengths=nothing, domain=nothing, merge_outregions=false, 
              verbose=false)</code></pre><p>Analyse a terrain and compute all key information regarding its trap structure.</p><p>This information includes the spillfield, all the spill regions, traps with their  volumes, spillpoints and footprints, the upstream/downstream trap hierarchy,  and the supertrap/subtrap hierarchy.  </p><p>All computed information is returned as a <a href="#TrapStructure"><code>TrapStructure</code></a>.  Refer to its documentation for details.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Matrix{&lt;:Real}</code>: topograpical grid to analyse</li><li><code>usediags::Bool</code>: if true, also consider slopes along diagonals</li><li><code>building_mask::Union{Matrix{&lt;:Bool}, BitMatrix, Nothing}</code>:      if present, provides a mask that specifies the footprint of buildings.       These parts of the domain will be clipped away.</li><li><code>sinks::Union{Vector{Tuple{Int, Int}}, Matrix{Bool}, Nothing}</code>:     vector containing (i, j) grid coordinates of any point sinks in the grid, if any.     Can also be a Matrix{Bool} of same size as <code>grid</code>, indicating the sink locations.</li><li><code>lengths::Union{Tuple{&lt;:Real, &lt;:Real}, Nothing}</code>:      tuple expressing the length and width of the grid (used to compute aspect ratios)</li><li><code>domain::Union{Domain2D, Nothing}</code>:      restrict computation to the specified domain of the grid.  @@ Note that this is not     fully supported yet for this function.</li><li><code>merge_outregions::Bool</code>: if <code>true</code>, all &quot;outside&quot; regions will be merged and      represented as region -1.   Otherwise, each &quot;outside&quot; region will be represented     by its own negative integer.</li><li><code>verbose::Bool</code>: if <code>true</code>, print information showing progress in the computation                   along the way.</li></ul><p>See also <a href="#TrapStructure"><code>TrapStructure</code></a>, <a href="../dynamic/#SurfaceWaterIntegratedModeling.fill_sequence-Tuple{TrapStructure, Vector{WeatherEvent}}"><code>fill_sequence</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillanalysis.jl#L5-L40">source</a></section></article><h2 id="Lower-level-functions"><a class="docs-heading-anchor" href="#Lower-level-functions">Lower-level functions</a><a id="Lower-level-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Lower-level-functions" title="Permalink"></a></h2><p>The functions listed below are used by the <a href="#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a> function.  They can however also be run independently.</p><h3 id="Spillfield"><a class="docs-heading-anchor" href="#Spillfield">Spillfield</a><a id="Spillfield-1"></a><a class="docs-heading-anchor-permalink" href="#Spillfield" title="Permalink"></a></h3><p>The <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a> function computes the basic gravity-driven flow pattern on a terrain.  For each cell, it determines the direction of flow and the correpsonding neighbor downstream cell, using either a 4-element or 8-element stencil.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling._spillfield!-Tuple{Matrix{Int8}, Array{&lt;:Real}, Matrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling._spillfield!-Tuple{Matrix{Int8}, Array{&lt;:Real}, Matrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling._spillfield!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_spillfield!(dir, slope, grid, usediags=true, lengths=nothing)</code></pre><p>Mutating version of spillfield.  The results &#39;dir&#39; and &#39;slope&#39; are not returned, but passed as arguments.  See documentation of &#39;spillfield&#39; for a general description.  A key difference in the mutating version is that the results (dir and slope) retain the full size of the grid, even though only a subdomain is addressed.  (In the non-mutating version, the returned grids are limited to the size of the addressed subdomain.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillfield.jl#L185-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.hconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.hconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.hconcat_spillfields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hconcat_spillfields(dir1, slope1, grid1, dir2, slope2, grid2, usediags=true, 
                    lengths=nothing)</code></pre><p>Concatenate two spill fields along the &#39;horizontal&#39; direction (adding columns).</p><p>In addition to the spill fields <code>dir1</code> and <code>dir2</code> to concatenate, the corresponding slopes and original terrain grids are also given (<code>slope1</code>, <code>slope2</code>,  <code>grid1</code>, <code>grid2</code>).  These are used to re-compute the spill directions for  gridcells on the &#39;seam&#39; between the two spill fields.</p><p>The function returns the combined spill field (corresponding to <code>[dir1, dir2]</code>), as  well as the associated slopes (corresponding to <code>[slope1, slope2]</code>)</p><p><strong>Arguments</strong></p><ul><li><code>dir1::Matrix{Int8}</code>: first spill field</li><li><code>slope1::Matrix{&lt;:Real}</code>: matrix with local slopes for first spill field</li><li><code>grid1::Matrix{&lt;:Real}</code>: topography grid from which <code>dir1</code> was computed</li><li><code>dir2::Matrix{Int8}</code>:  second spill field</li><li><code>slope2::Matrix{&lt;:Real}</code>: matrix with local slopes for second spill field</li><li><code>grid2::Matrix{&lt;:Real}</code>: topography grid from which <code>dir2</code> was computed</li><li><code>usediags::Bool</code>: if true, also consider slopes along diagonals</li><li><code>lengths::Union{Tuple{&lt;:Real}, Nothing}</code>:      tuple expressing the length and width of the combined grid (used to compute     aspect ratios)</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>, <a href="#SurfaceWaterIntegratedModeling.vconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>vconcat_spillfields</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillfield.jl#L304-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.spillfield</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spillfield(grid, usediags=true, lengths=nothing, domain=nothing, 
           tiling=nothing, building_mask=nothing)</code></pre><p>Compute the spillfield of a raster terrain, represented by <code>grid</code>.  </p><p>The spillfield is returned an integer array of same shape as <code>grid</code>, to be interpreted as follows: </p><ul><li>-3 : sink (any passing streamline is terminated here)</li><li>-2 : covered by building / clipped away</li><li>-1 : no downward slope (gridcell is a trap)</li><li>0 : steepest slope towards (i-1, j)</li><li>1 : steepest slope towards (i+1, j)</li><li>2 : steepest slope towards (i, j-1)</li><li>3 : steepest slope towards (i, j+1)</li><li>4 : steepest slope towards (i-1, j-1)</li><li>5 : steepest slope towards (i+1, j+1)</li><li>6 : steepest slope towards (i+1, j-1)</li><li>7 : steepest slope towards (i-1, j+1)</li></ul><p>Trap bottoms, i.e. cells for which there exists no downward slope, are given the value -1.</p><p>In addition, a matrix with the value of the steepest slope in each point is returned as a second argument.   </p><p><strong>Arguments</strong></p><ul><li><code>grid::Matrix{&lt;:Real}</code>: terrain raster grid with height values</li><li><code>usediags::Bool</code>: if true, also consider slopes along diagonals</li><li><code>building_mask::Union{Matrix{Bool}, BitMatrix, Nothing}</code>:      a grid of logicals, specifying which cells are masked by buildings (true),      and thus inactive. These cells will be assigned a spill field value of -2     (see list above).</li><li><code>sinks::Union{Vector{Tuple{Int, Int}}, Nothing}</code>:      vector containing (i, j) grid coordinates of any point sinks in the grid, if any</li><li><code>lengths::Union{Tuple{&lt;:Real, &lt;:Real}, Nothing}</code>:      tuple expressing the length and width of the grid (used to compute aspect ratios)</li><li><code>domain::Union{Domain2D, Nothing}</code>: restrict computation to the specified domain                                     of the grid</li><li><code>tiling::Union{Tuple{Int, Int}, Nothing}</code>:      tuple specifying number of &#39;tiles&#39; to subdivide surface in for parallel     processing.  Default is (1,1), which means the whole surface is treated     as a single tile (no parallel processing).</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.update_spillfield!-Tuple{Matrix{Int8}, Array{&lt;:Real}, Matrix{&lt;:Real}, Domain2D}"><code>update_spillfield!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillfield.jl#L12-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.update_spillfield!-Tuple{Matrix{Int8}, Array{&lt;:Real}, Matrix{&lt;:Real}, Domain2D}" href="#SurfaceWaterIntegratedModeling.update_spillfield!-Tuple{Matrix{Int8}, Array{&lt;:Real}, Matrix{&lt;:Real}, Domain2D}"><code>SurfaceWaterIntegratedModeling.update_spillfield!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_spillfield!(dir, slope, grid, domain, usediags=true, lengths=nothing)</code></pre><p>Update an existing spill field in-place within a specific rectangular domain (where  the topography grid has presumably changed).</p><p><strong>Arguments</strong></p><ul><li><p><code>dir::Matrix{Int}</code> : the spillfield, as described in the documentation of the                      <code>spillfield</code> function.  Will be updated within the                      specified domain.</p></li><li><p><code>slope::Array{&lt;:Real}</code>: the steepest slope in each grid point, as returned by                         the <code>spillfield</code> function.  Will be updated within the                         specified domain.</p></li><li><p><code>grid::Matrix{&lt;:Real}</code>: terrain raster grid with height values.  This grid has                         presumably already been changed within the specified                          domain.</p></li><li><p><code>domain::Domain2D</code> : the domain in which to update the information in <code>dir</code>                       and <code>slope</code></p></li><li><p><code>usediags::Bool=true</code>: if true, also consider slopes along diagonals</p></li><li><p><code>lengths::Union{Tuple{&lt;:Real, &lt;:Real}, Nothing}</code>:      tuple expressing the length and width of the grid (used to compute aspect ratios)</p></li><li><p><code>building_mask::Union{Matrix{Bool}, Nothing}</code>:      a grid of logicals, specifying which cells are masked by buildings (true),      and thus inactive. These cells will be assigned a spill field value of -2      (see list of possible fieldvalues in documentation of <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>.)</p></li><li><p><code>sinks::Vector{Union{Tuple{Int, Int}, Nothing}}</code>:      vector containing (i, j) grid coordinates of any point sinks in the grid, if any.</p></li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillfield.jl#L108-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.vconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}" href="#SurfaceWaterIntegratedModeling.vconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>SurfaceWaterIntegratedModeling.vconcat_spillfields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vconcat_spillfields(dir1, slope1, grid1, dir2, slope2, grid2, usediags=true, 
                    lengths=nothing)</code></pre><p>Concatenate two spill fields along the &#39;vertical&#39; direction (adding rows).</p><p>In addition to the spill fields <code>dir1</code> and <code>dir2</code> to concatenate, the corresponding slopes and original terrain grids are also given (<code>slope1</code>, <code>slope2</code>,  <code>grid1</code>, <code>grid2</code>).  These are used to re-compute the spill directions for  gridcells on the &#39;seam&#39; between the two spill fields.</p><p>The function returns the combined spill field (corresponding to <code>[dir1; dir2]</code>), as  well as the associated slopes (corresponding to <code>[slope1; slope2]</code>)</p><p><strong>Arguments</strong></p><ul><li><code>dir1::Matrix{Int8}</code>: first spill field</li><li><code>slope1::Matrix{&lt;:Real}</code>: matrix with local slopes for first spill field</li><li><code>grid1::Matrix{&lt;:Real}</code>: topography grid from which <code>dir1</code> was computed</li><li><code>dir2::Matrix{Int8}</code>:  second spill field</li><li><code>slope2::Matrix{&lt;:Real}</code>: matrix with local slopes for second spill field</li><li><code>grid2::Matrix{&lt;:Real}</code>: topography grid from which <code>dir2</code> was computed</li><li><code>usediags::Bool</code>: if true, also consider slopes along diagonals</li><li><code>lengths::Union{Tuple{&lt;:Real}, Nothing}</code>:      tuple expressing the length and width of the combined grid (used to compute     aspect ratios)</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>, <a href="#SurfaceWaterIntegratedModeling.hconcat_spillfields-Tuple{Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{Int8}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>hconcat_spillfields</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillfield.jl#L232-L259">source</a></section></article><h3 id="Spillregions"><a class="docs-heading-anchor" href="#Spillregions">Spillregions</a><a id="Spillregions-1"></a><a class="docs-heading-anchor-permalink" href="#Spillregions" title="Permalink"></a></h3><p>For a given spillfield (as computed by the <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a> function), the <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a> function separates the terain into individual watersheds, each associated with a local minimum in the terrain surface. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}" href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>SurfaceWaterIntegratedModeling.spillregions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spillregions(spillfield)</code></pre><p>Identify all spill regions to be derived from a given <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>.</p><p>A spill region is a group of cells that flow into the same trap (here: the lowest-level traps).</p><p>Returns a Matrix{Int} of the same shape as <code>spillfield</code>, where all cells with the same integer value belong to the same spill region.  Spill regions that  exit the domain are assigned negative region numbers.</p><p><strong>Arguments</strong></p><ul><li><code>spillfield::Matrix{Int}</code>: the matrix containing the spillfield already                             computed from the <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a> function.</li><li><code>usediags</code> : if <code>true</code>, diagonal connections between cells will also be considered</li><li><code>tiling::Union{Tuple{Int, Int}, Nothing}</code>:      tuple specifying number of &#39;tiles&#39; to subdivide surface in for parallel      processing.  Default is (1,1), which means the whole surface is treated     as a single tile (no parallel processing).</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.spillfield-Tuple{Matrix{&lt;:Real}}"><code>spillfield</code></a>, <a href="#SurfaceWaterIntegratedModeling.update_spillregions!-Tuple{Matrix{Int64}, Matrix{Int8}, Domain2D}"><code>update_spillregions!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillregions.jl#L9-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.update_spillregions!-Tuple{Matrix{Int64}, Matrix{Int8}, Domain2D}" href="#SurfaceWaterIntegratedModeling.update_spillregions!-Tuple{Matrix{Int64}, Matrix{Int8}, Domain2D}"><code>SurfaceWaterIntegratedModeling.update_spillregions!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_spillregions!(regions, spillfield, domain; usediags=true, 
                     return_region_reindex=false)</code></pre><p>Update a previously computed spillregion field inside a limited domain (where the spillfield has presumably changed).</p><p><strong>Arguments</strong></p><ul><li><code>regions::Matrix{Int}</code>        : the previously computed spillregion field</li><li><code>spillfield::Matrix{Int8}</code>    : the locally updated spill field</li><li><code>domain::Domain2D</code>            : domain within which the spillfield has changed,                                  and thus regions need to be updated</li><li><code>usediags{Bool}</code>              : if <code>true</code>, diagonal connections between cells                                  will also be considered</li><li>`return<em>region</em>reindex{Bool}&#39; : compute and return correspondence between old                                  and new region indices as a 2-column matrix,                                  first column represents old region numbers and                                  second column the new ones.  Note that there                                  may be both one-to-one, one-to-many and                                 many-to-one correspondences.</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillregions.jl#L74-L96">source</a></section></article><h3 id="Spillpoints"><a class="docs-heading-anchor" href="#Spillpoints">Spillpoints</a><a id="Spillpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Spillpoints" title="Permalink"></a></h3><p>The <a href="#SurfaceWaterIntegratedModeling.Spillpoint"><code>Spillpoint</code></a> struct contains the information for a particular spill point, i.e. the point where a trap/lake spills over.  <code>Spillpoint</code> contains the index of the downstream region, the location of the spillpoint itself, as well as its vertical elevation.</p><p>The <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> function is used to compute all the spillpoints associated with a set of <em>spill regions</em> (which has been previously computed using <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.Spillpoint" href="#SurfaceWaterIntegratedModeling.Spillpoint"><code>SurfaceWaterIntegratedModeling.Spillpoint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Spillpoint</code></pre><p>A struct representing the spillpoint of a trap.  It has the following fields:</p><ul><li><code>downstream_region::Int</code>: index of the downstream region.</li><li><code>current_region_cell::Int</code>: index of the cell in the current region bordering on                              the spillpoint</li><li><code>downstream_region_cell::Int</code>: index of the cell in the downstream region                                 bordering on the spillpoint</li><li><code>elevation::Real</code>: the elevation (vertical height) of the spillpoint</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillpoints.jl#L5-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.Spillpoint-Tuple{}" href="#SurfaceWaterIntegratedModeling.Spillpoint-Tuple{}"><code>SurfaceWaterIntegratedModeling.Spillpoint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Default constructor of a Spillpoint instance sets all indices to zero and elevation to infinity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillpoints.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}" href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>SurfaceWaterIntegratedModeling.spillpoints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spillpoints(grid, spillregions, usediags)</code></pre><p>Compute the spillpoint positions for each (low-level) spill region in the grid.</p><p>Also computes the topology of the lowest-level spill network (the graph describing the upstream/downstream relationship between spill regions).</p><p>Returns a vector of <a href="#SurfaceWaterIntegratedModeling.Spillpoint"><code>Spillpoint</code></a> with one entry per spill region (numbered from 1 upwards.  Each <a href="#SurfaceWaterIntegratedModeling.Spillpoint"><code>Spillpoint</code></a> contains information on downstream spill region index, cell indices for the cell in the current region and downstream region that border on the spill point, and the heigh volume of the spill point.</p><p>In addition, returns a vector of &#39;boundaries&#39;, one per spill point.  The boundary for  spill region &#39;i&#39; is defined by all the cell pairs (i, j) such that cell &#39;i&#39;, and &#39;j&#39;  are neighbors, cell &#39;i&#39; is in spill region &#39;i&#39;, and cell &#39;j&#39; is in a different spill region &#39;j&#39;.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Matrix{&lt;:Real}</code> - the terrain grid (matrix) with height values</li><li><code>spillregions::Matrix{Int}</code>: the matrix containing the regions already computed                                from the <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a> function</li><li><code>usediags::Bool</code> : if <code>true</code> (default), diagonal connections between cells will also be                    considered</li><li><code>tiling::Union{Tuple{Int, Int}, Nothing}</code>:        tuple specifying number of &#39;tiles&#39; to subdivide surface in for parallel       processing.  Default is (1,1), which means the whole surface is treated       as a single tile (no parallel processing).</li></ul><p>See also <a href="#SurfaceWaterIntegratedModeling.Spillpoint"><code>Spillpoint</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/spillpoints.jl#L33-L64">source</a></section></article><h3 id="Subtrap-supertrap-hierarchy"><a class="docs-heading-anchor" href="#Subtrap-supertrap-hierarchy">Subtrap-supertrap hierarchy</a><a id="Subtrap-supertrap-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Subtrap-supertrap-hierarchy" title="Permalink"></a></h3><p>The <a href="#SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}"><code>sshierarchy!</code></a> identifies higher-level traps from a set of subtraps. In other words, it identifies those traps that emerges when smaller traps coalesce as they fill up.  It requires the output of <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a> and <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> as part of it input.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}" href="#SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}"><code>SurfaceWaterIntegratedModeling.sshierarchy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sshierarchy!(grid, spillregions, spillpoints, boundaries)</code></pre><p>Identify higher-level traps and spillpoints, resulting from merger of lower-level traps that flow into each other.</p><p>The vector of <em>spillpoints</em>, and the associated <em>spillregion boundaries</em> will be updated with the higher-level spillpoints and traps.</p><p>The arguments <code>grid</code> and <code>spillregions</code> will remain unmodified.</p><p>The function also returns a <em>graph</em> representing the hierarchy of subtraps and supertraps, and a <em>vector</em> listing the indices of the lowest-level spillregions contained within each trap.  For lowest-level traps, this list only references the trap itself, whereas for higher-level traps, it references all the low-level traps whose merger leads to the higher-level trap.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Matrix{&lt;:Real}</code>: terrain raster grid with height values.  This                         input argument remains unmodified.</li><li><code>spillregions::Matrix{Int}</code>: the matrix containing the lowest-level                               regions, already computed from the                               <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a> function.  This                              input argument remains unmodified.</li><li><code>spillpoints::Vector{Spillpoint}</code>: vector of lowest-level spillpoints                                    (corresponding to the lowest-level                                     regions), as computed by the                                     <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> function.                                      This vector will be modified, as it                                     will be supplemented with the newly                                    identified, higher-level spillpoints.</li><li><code>boundaries::Vector{Vector{Tuple{Int, Int}}}</code>:            vector containing the boundaries for each of the lowest-level spill           regions.  This vector will be modified, as it will be extended           with the boundaries of the newly found higher-level spill regions.           Each boundary is represented by a vector of integer pairs, where            each integer pair are the indices of two neighbor cells in the grid;           one on each side of the region boundary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/sshierarchy.jl#L4-L42">source</a></section></article><h3 id="Trap-volumes"><a class="docs-heading-anchor" href="#Trap-volumes">Trap volumes</a><a id="Trap-volumes-1"></a><a class="docs-heading-anchor-permalink" href="#Trap-volumes" title="Permalink"></a></h3><p>The function [<code>trapvolumes</code>][@ref] is used to compute the volumes of all traps and subtraps identified on an analysed surface. It requires the result of  <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a> and <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> as input parameters.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.trapvolumes-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector{Spillpoint}, Vector{Vector{Int64}}}" href="#SurfaceWaterIntegratedModeling.trapvolumes-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector{Spillpoint}, Vector{Vector{Int64}}}"><code>SurfaceWaterIntegratedModeling.trapvolumes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trapvolumes(grid, spillregions, spillpoints, lowest_regions)</code></pre><p>Compute the volume of all traps (at all levels) identified for a topography grid.</p><p>The necessary input to this function can be provided by <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a>,  <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> and <a href="#SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}"><code>sshierarchy!</code></a>.  The result is returned in form of a vector of floating point numbers, with one entry per trap, giving the volume  of that trap.</p><p><strong>Arguments</strong></p><pre><code class="language-julia hljs">- `grid::Matrix{&lt;:Real}`: the topographical grid that has been analysed 
- `spillregions::Matrix{Int}`: of same size as `grid`, where the integer at entry
                               (i, j) gives the region number of cell (i, j) in `grid`.
- `spillpoints::Vector{Spillpoint}`: vector with the identified spillpoints, as
                                     provided by the [`spillpoints`](@ref) function.
                                     There is one spillpoint per trap.
- `lowest_regions::Vector{Vector{Int}}`: each entry in this vector corresponds to 
                                         a trap, and list all the low-level regions
                                         that combined constitute the spill region
                                         of this trap.</code></pre><p>See also <a href="#SurfaceWaterIntegratedModeling.spillregions-Tuple{Matrix{Int8}}"><code>spillregions</code></a>, <a href="#SurfaceWaterIntegratedModeling.spillpoints-Tuple{Matrix{&lt;:Real}, Matrix{Int64}}"><code>spillpoints</code></a> and <a href="#SurfaceWaterIntegratedModeling.sshierarchy!-Tuple{Matrix{&lt;:Real}, Matrix{Int64}, Vector, Vector{Vector{Tuple{Int64, Int64}}}}"><code>sshierarchy!</code></a>.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/trapvolumes.jl#L4-L27">source</a></section></article><h3 id="Domain"><a class="docs-heading-anchor" href="#Domain">Domain</a><a id="Domain-1"></a><a class="docs-heading-anchor-permalink" href="#Domain" title="Permalink"></a></h3><p>The <code>Domain2D</code> struct represent a rectangular subpart of a terrain grid.  It is mainly used to specify subsets of a terrain that should be updated or processed in parallel.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.Domain2D" href="#SurfaceWaterIntegratedModeling.Domain2D"><code>SurfaceWaterIntegratedModeling.Domain2D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Domain2D</code></pre><p>Type representing a Cartesian (sub)domain of a grid, defined by all gridcells indexed (ix, iy) such that ix ∈ xrange and iy ∈ yrange.</p><p>Fields</p><ul><li><code>xrange::UnitRange{Int}</code>: range of domain in the first coordinate direction</li><li><code>yrange::UnitRange{Int}</code>: range of domain in the second coordinate direction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.max-Tuple{Domain2D, Int64}" href="#Base.max-Tuple{Domain2D, Int64}"><code>Base.max</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max(d::Domain2D, dir::Int)</code></pre><p>Return maximum value of 2D domain <code>d</code>, in first or second direction</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.min-Tuple{Domain2D, Int64}" href="#Base.min-Tuple{Domain2D, Int64}"><code>Base.min</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">min(d::Domain2D, dir::Int)</code></pre><p>Return minimum value of 2D domain <code>d</code>, in first or second direction</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{Domain2D}" href="#Base.size-Tuple{Domain2D}"><code>Base.size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>size(d::Domain2D)</p><p>Return size of 2D domain d</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.tiledomain-Tuple{Domain2D, Any, Any}" href="#SurfaceWaterIntegratedModeling.tiledomain-Tuple{Domain2D, Any, Any}"><code>SurfaceWaterIntegratedModeling.tiledomain</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tiledomain(dom, tilenum_x, tilenum_y)</code></pre><p>Divide a given domain up into a cartesian grid of subdomains (&#39;tiles&#39;)</p><p>The domain &#39;dom&#39; is split up into a grid of domains, with &#39;tilenum_x&#39; number of domain in the first coordinate direction, and &#39;tilenum_y number of domains in the second.  </p><p>Returns a Vector{Domain2D} with all the resulting subdomains.  A second return argument gives a tuple of integer vectors specifying where the splits happened in the first and second coordinate directions.</p><p>See also <a href="#SurfaceWaterIntegratedModeling.Domain2D"><code>Domain2D</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L47-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SurfaceWaterIntegratedModeling.tiles-Tuple{Vector{Int64}, Vector{Int64}}" href="#SurfaceWaterIntegratedModeling.tiles-Tuple{Vector{Int64}, Vector{Int64}}"><code>SurfaceWaterIntegratedModeling.tiles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tiles(xsplit::Vector{Int}, ysplit::Vector{Int})</code></pre><p>Divide a domain up into a cartesian grid of subdomains (&#39;tiles&#39;)</p><p>The vectors <code>xsplit</code> and <code>ysplit</code> should be monotonously increasing integer vectors that specify where to split an underlying 2D region into subdomains.</p><p>The function will return a vector of <a href="#SurfaceWaterIntegratedModeling.Domain2D"><code>Domain2D</code></a> that tile the  domain.  If <code>xsplit</code> is of length Nx and <code>ysplit</code> of length Ny, the number of tiles generated will be (Nx-1) x (Ny-1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/185f6d61b15067a07967530e961d4768a74f7a24/src/domain.jl#L77-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flat_areas/">« Handling flat areas</a><a class="docs-footer-nextpage" href="../dynamic/">Dynamic analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 7 November 2025 11:27">Friday 7 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
