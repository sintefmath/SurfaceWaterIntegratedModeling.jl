<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Handling flat areas · SWIM</title><meta name="title" content="Handling flat areas · SWIM"/><meta property="og:title" content="Handling flat areas · SWIM"/><meta property="twitter:title" content="Handling flat areas · SWIM"/><meta name="description" content="Documentation for SWIM."/><meta property="og:description" content="Documentation for SWIM."/><meta property="twitter:description" content="Documentation for SWIM."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SWIM logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SWIM</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../urban/">Urban landscape</a></li><li><a class="tocitem" href="../synthetic/">Simple synthetic example</a></li><li class="is-active"><a class="tocitem" href>Handling flat areas</a><ul class="internal"><li><a class="tocitem" href="#Imporing-packages-and-loading-the-surface."><span>Imporing packages and loading the surface.</span></a></li><li><a class="tocitem" href="#Identifying-flat-areas-and-running-spill-analysis"><span>Identifying flat areas and running spill analysis</span></a></li><li><a class="tocitem" href="#Adding-more-sinks"><span>Adding more sinks</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../static/">Static analysis</a></li><li><a class="tocitem" href="../dynamic/">Dynamic analysis</a></li><li><a class="tocitem" href="../utils/">Utilities and visualization</a></li><li><a class="tocitem" href="../indexlist/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Handling flat areas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Handling flat areas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sintefmath/SurfaceWaterIntegratedModeling.jl/blob/main/examples/flat_areas.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Handling-flat-areas"><a class="docs-heading-anchor" href="#Handling-flat-areas">Handling flat areas</a><a id="Handling-flat-areas-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-flat-areas" title="Permalink"></a></h1><p>This is a simple demonstration of how large flat surfaces (like large water bodies) can be recognized, and straightened or excluded from analysis if desired <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><h2 id="Imporing-packages-and-loading-the-surface."><a class="docs-heading-anchor" href="#Imporing-packages-and-loading-the-surface.">Imporing packages and loading the surface.</a><a id="Imporing-packages-and-loading-the-surface.-1"></a><a class="docs-heading-anchor-permalink" href="#Imporing-packages-and-loading-the-surface." title="Permalink"></a></h2><pre><code class="language-julia hljs">using SurfaceWaterIntegratedModeling
import CairoMakie, Images # for visualization and loading of textures
import ColorSchemes
using Pkg.Artifacts</code></pre><p>The package with SWIM testdata is provided as a Julia artifact, which can be accessed using the function <code>datapath_testdata</code>.  We subsequently load and display the synthetic grid.</p><pre><code class="language-julia hljs">datapath = joinpath(datapath_testdata(), &quot;data&quot;, &quot;small&quot;)
grid = loadgrid(joinpath(datapath, &quot;bay.txt&quot;));

# for ease of use, we create our own label of key colors found in the
# colorsheme `:Paired_12` used below
cmap = Dict(:blue =&gt; 2, :green =&gt; 4, :red =&gt; 6, :orange =&gt; 8,
            :lilac =&gt; 10, :bright =&gt; 11);

# Also define a preset viewpoint
view1 = (CairoMakie.Vec(1059, 783, 622), CairoMakie.Vec(280, 311, 58), 0.68);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32"><span class="sgr1"> Downloading</span></span> artifact: swim_testdata</code></pre><p>The terrain used for demonstration is a varied surface that includes hills, a mountainside, a road, and ocean areas.</p><pre><code class="language-julia hljs">tex = fill(cmap[:green], size(grid))
sf, fig, sc = plotgrid(grid, texture = tex,
                       colormap=ColorSchemes.:Paired_12,
                       colorrange=(1,12))
set_camerapos(sc, view1...)</code></pre><img src="7209e663.png" alt="Example block output"/><h2 id="Identifying-flat-areas-and-running-spill-analysis"><a class="docs-heading-anchor" href="#Identifying-flat-areas-and-running-spill-analysis">Identifying flat areas and running spill analysis</a><a id="Identifying-flat-areas-and-running-spill-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Identifying-flat-areas-and-running-spill-analysis" title="Permalink"></a></h2><p>While the ocean part is clearly visible on the surface, its cells in the terrain grid have not been identified.  For this purpose, the <a href="../utils/#SurfaceWaterIntegratedModeling.identify_flat_areas"><code>identify_flat_areas</code></a> function can be used:</p><pre><code class="language-julia hljs">rel_tol = 1e-3 # relative tolerance for an angle between two cells to be considered zero
max_cluster_size = 1 # threshold for excluding too small areas
isflat = identify_flat_areas(grid, rel_tol, max_cluster_size)

tex[isflat] .= cmap[:blue]
drape_surface(sf, tex)
set_camerapos(sc, view1...)</code></pre><img src="693a8f45.png" alt="Example block output"/><p>We can see that the ocean part was correctly identified as flat, but so were many parts that ought not be included.  We can increase the cluster size limit to filter these parts out.</p><pre><code class="language-julia hljs">max_cluster_size=100
isflat = identify_flat_areas(grid, rel_tol, max_cluster_size)

tex[isflat] .= cmap[:blue]
tex[.!isflat] .= cmap[:green]
drape_surface(sf, tex)
set_camerapos(sc, view1...)</code></pre><img src="5d93f73c.png" alt="Example block output"/><p>With this value for the threshold, only the ocean remains identified as flat.</p><p>For the surface used in this example, the ocean surface is already exactly flat.  However, it is sometimes the case with terrain input data that conceptually flat regions still contains small irregularities that may cause noisy output from the spill analysis.  One way to handle this, is to use the <a href="../utils/#SurfaceWaterIntegratedModeling.flatten_grid!-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Bool}, Symbol}"><code>flatten_grid!</code></a> function, which ensures that flat parts are exactly that.  Even if not strictly necessary for our sample terrain, we demonstrate the use below:</p><pre><code class="language-julia hljs">flatten_grid!(grid, isflat, :min)</code></pre><p>Another way to exclude flat areas from the analysis is to declare them as &quot;sinks&quot;.  For oceans, this makes conceptual sense, since they can be considered traps with &quot;infinite&quot; capacity.  For other large flat areas, e.g. parking lots, this approach does not work so well, and <code>flatten_grid!</code> should be used.  For our terrain, declaring the flat areas as sinks should be fine.  We pass along <code>isflat</code> as the sink map in our call to <a href="../static/#SurfaceWaterIntegratedModeling.spillanalysis-Tuple{Matrix{&lt;:Real}}"><code>spillanalysis</code></a> below:</p><pre><code class="language-julia hljs">tstruct = spillanalysis(grid, sinks=isflat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TrapStructure{Float64}([114.64 113.62 … 30.184 29.403; 114.93 114.0 … 30.002 29.197; … ; 86.445 86.805 … 32.437 32.877; 86.009 86.429 … 32.419 32.88], Int8[3 3 … 3 3; 3 7 … 5 3; … ; 1 6 … 2 2; 1 2 … 2 2], [-1 -1 … -56418 -56418; -1 -1 … -56515 -56612; … ; -52 -52 … -56417 -56417; -52 -52 … -56514 -56514], Spillpoint[Spillpoint(134, 83048, 83049, 4.3057), Spillpoint(58, 51885, 51884, 37.931), Spillpoint(40, 22595, 22594, 75.583), Spillpoint(134, 80346, 80798, 4.7259), Spillpoint(4, 25778, 26228, 70.685), Spillpoint(137, 82168, 82169, 3.2237), Spillpoint(154, 84888, 85340, 2.555), Spillpoint(161, 87159, 87609, 1.7134), Spillpoint(11, 19498, 19499, 74.053), Spillpoint(44, 19054, 19504, 73.804)  …  Spillpoint(-9145, 83628, 83629, 5.1506), Spillpoint(148, 83940, 83939, 4.4768), Spillpoint(4, 80798, 80346, 4.7259), Spillpoint(121, 81239, 80789, 4.8328), Spillpoint(127, 77697, 77245, 4.9052), Spillpoint(110, 83031, 83481, 5.3576), Spillpoint(145, 83929, 83928, 5.9195), Spillpoint(149, 85267, 85717, 7.0289), Spillpoint(124, 87064, 87063, 7.8472), Spillpoint(-9144, 87947, 87946, 8.4201)], [0.15759999999999952, 0.01899999999999835, 0.04399999999999693, 0.04630000000000045, 0.04200000000000159, 1.1318000000000001, 0.1871000000000005, 1.2660000000000002, 0.2009999999999934, 0.0  …  2560.1657999999984, 1289.7652000000007, 1621.6218, 1780.6920000000011, 1894.2151000000003, 2713.6629999999977, 3961.6346999999982, 7065.913900000009, 9881.127499999986, 12192.254699999985], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  2479.6928, 1277.9733000000008, 1289.7728000000006, 1621.6680999999999, 1780.748600000001, 1894.2469000000003, 2713.989299999998, 3964.7893999999983, 7066.0303000000085, 9893.510299999985], [[83046, 83047, 83048], [51885], [22595, 22596], [80345, 80346], [25778], [81711, 81712, 81713, 81714, 81715, 81716, 82163, 82164, 82165, 82166, 82167, 82168, 82618, 82619], [83985, 84436, 84437, 84888], [86258, 86259, 86260, 86261, 86708, 86709, 86710, 86711, 87159, 87160, 87161, 87162], [19498, 19948, 19949], [19054]  …  [70542, 70544, 70545, 70546, 70991, 70992, 70993, 70994, 70995, 70996  …  112963, 113414, 113865, 113866, 114318, 114770, 115222, 115673, 115674, 116125], [78143, 78593, 78594, 79044, 79045, 79495, 79496, 79945, 79946, 79947  …  97080, 97081, 97082, 97526, 97527, 97528, 97529, 97530, 97531, 97532], [76790, 77241, 77691, 77692, 78141, 78142, 78143, 78591, 78592, 78593  …  97529, 97530, 97531, 97532, 97533, 97979, 97980, 97981, 97982, 97983], [76790, 77241, 77242, 77691, 77692, 78141, 78142, 78143, 78144, 78147  …  97533, 97978, 97979, 97980, 97981, 97982, 97983, 97984, 98429, 98430], [76339, 76790, 77240, 77241, 77242, 77691, 77692, 77693, 77697, 78140  …  97978, 97979, 97980, 97981, 97982, 97983, 97984, 98429, 98430, 98880], [75887, 75888, 75891, 75892, 75893, 75894, 76337, 76338, 76339, 76340  …  98879, 98880, 98881, 98882, 98883, 98884, 98885, 98886, 99331, 99332], [74988, 74989, 74990, 74991, 74992, 74993, 74994, 75436, 75437, 75438  …  99782, 99783, 99784, 99785, 99786, 100232, 100233, 100234, 100235, 100684], [73189, 73190, 73191, 73192, 73639, 73640, 73641, 73642, 73643, 74083  …  101589, 102035, 102036, 102037, 102486, 102487, 102488, 102938, 102939, 103389], [71838, 72287, 72288, 72289, 72290, 72735, 72736, 72737, 72738, 72739  …  102939, 102940, 103388, 103389, 103390, 103391, 103839, 103840, 103841, 104291], [70936, 70937, 71384, 71385, 71386, 71387, 71388, 71389, 71834, 71835  …  103849, 104289, 104290, 104291, 104292, 104741, 104742, 105192, 105193, 105644]], [[1], [2], [3], [4], [5], [6], [7], [8], [9], [10]  …  [207, 187, 170, 180, 177, 176, 140, 143, 155, 157  …  119, 135, 174, 203, 198, 200, 194, 192, 208, 223], [1, 160, 137, 128, 167, 7, 146, 161, 8, 154, 166, 162, 159, 6, 142, 134, 11, 147, 151], [1, 160, 137, 128, 167, 7, 146, 161, 8, 154, 166, 162, 159, 6, 142, 134, 11, 147, 151, 148], [1, 160, 137, 128, 167, 7, 146, 161, 8, 154  …  162, 159, 6, 142, 134, 11, 147, 151, 148, 4], [1, 160, 137, 128, 167, 7, 146, 161, 8, 154  …  159, 6, 142, 134, 11, 147, 151, 148, 4, 121], [1, 160, 137, 128, 167, 7, 146, 161, 8, 154  …  6, 142, 134, 11, 147, 151, 148, 4, 121, 127], [110, 1, 160, 137, 128, 167, 7, 146, 161, 8  …  6, 142, 134, 11, 147, 151, 148, 4, 121, 127], [110, 1, 160, 137, 128, 167, 7, 146, 161, 8  …  134, 11, 147, 151, 148, 4, 121, 127, 141, 145], [110, 1, 160, 137, 128, 167, 7, 146, 161, 8  …  11, 147, 151, 148, 4, 121, 127, 141, 145, 149], [110, 1, 160, 137, 128, 167, 7, 146, 161, 8  …  148, 4, 121, 127, 141, 145, 149, 153, 158, 124]], [[1, 1108, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118], [2], [3], [4, 1112, 1113, 1114, 1115, 1116, 1117, 1118], [5], [6, 1098, 1101, 1103, 1105, 1106, 1108, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118], [7, 1057, 1071, 1076, 1085, 1087, 1094, 1097, 1098, 1101  …  1108, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118], [8, 897, 1002, 1038, 1057, 1071, 1076, 1085, 1087, 1094  …  1108, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118], [9], [10]  …  [886], [887], [888], [889], [890, 991], [891, 993], [892, 993], [893], [894], [895]], Graphs.SimpleGraphs.SimpleDiGraph{Int64}(446, [[1108], Int64[], Int64[], [1112], Int64[], [1098], [1057], [897], Int64[], Int64[]  …  Int64[], [1111], [1112], [1113], [1114], [1115], [1116], [1117], [1118], Int64[]], [Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[]  …  [223, 1107], [151, 1108], [148, 1110], [4, 1111], [121, 1112], [127, 1113], [110, 1114], [911, 1115], [149, 1116], [1029, 1117]]), nothing, [(448, 113), (451, 113), (442, 114), (443, 114), (444, 114), (447, 114), (448, 114), (449, 114), (450, 114), (451, 114)  …  (161, 601), (162, 601), (163, 601), (164, 601), (165, 601), (166, 601), (167, 601), (168, 601), (169, 601), (170, 601)])</code></pre><p>The spill anaysis was able to identify 895 spill regions and 1118 traps:</p><pre><code class="language-julia hljs">print(&quot;Number of spill regions identified: &quot;, numregions(tstruct), &#39;\n&#39;)
print(&quot;Number of traps identified: &quot;, numtraps(tstruct), &#39;\n&#39;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Number of spill regions identified: 895
Number of traps identified: 1118</code></pre><p>We can visualize the traps, spill regions, rivers and oceans on the terrain surface by creating a texture with <a href="../utils/#SurfaceWaterIntegratedModeling.show_region_selection-Tuple{TrapStructure}"><code>show_region_selection</code></a>:</p><pre><code class="language-julia hljs">tex = show_region_selection(tstruct,
                            region_color=cmap[:green],
                            river_color=cmap[:blue]-1,
                            trap_color=cmap[:blue]);</code></pre><p>Terrain that spills directly to the ocean, or out of the domain is assigned a light green color, to distinguish it from terrain that spills to identified traps, while the ocean is set to blue:</p><pre><code class="language-julia hljs">tex[tex.==0] .= cmap[:green]-1;
tex[isflat] .= cmap[:blue];

drape_surface(sf, tex)
set_camerapos(sc, view1...)</code></pre><img src="5c434ed9.png" alt="Example block output"/><h2 id="Adding-more-sinks"><a class="docs-heading-anchor" href="#Adding-more-sinks">Adding more sinks</a><a id="Adding-more-sinks-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-more-sinks" title="Permalink"></a></h2><p>The ridge in front of the large lake in the upper left part of the plot is actually a railroad.  The regions immediately in front of it and behind it should be considered drained, so water does not massively accumulated like the above plot indicates.  By adding a drain near its lowest point, the lake goes away:</p><pre><code class="language-julia hljs">sinks = [(119,193), (180, 193)]; # two drain locations
for s in sinks
    # add the sinks to the map that we used to represent sinks (and flat areas)
    isflat[s...] = true;
end

# run the spill analysis again
tstruct = spillanalysis(grid, sinks=isflat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TrapStructure{Float64}([114.64 113.62 … 30.184 29.403; 114.93 114.0 … 30.002 29.197; … ; 86.445 86.805 … 32.437 32.877; 86.009 86.429 … 32.419 32.88], Int8[3 3 … 3 3; 3 7 … 5 3; … ; 1 6 … 2 2; 1 2 … 2 2], [-1 -1 … -56420 -56420; -1 -1 … -56517 -56614; … ; -52 -52 … -56419 -56419; -52 -52 … -56516 -56516], Spillpoint[Spillpoint(134, 83048, 83049, 4.3057), Spillpoint(58, 51885, 51884, 37.931), Spillpoint(40, 22595, 22594, 75.583), Spillpoint(134, 80346, 80798, 4.7259), Spillpoint(4, 25778, 26228, 70.685), Spillpoint(137, 82168, 82169, 3.2237), Spillpoint(154, 84888, 85340, 2.555), Spillpoint(-9626, 86710, 86711, 1.569), Spillpoint(11, 19498, 19499, 74.053), Spillpoint(44, 19054, 19504, 73.804)  …  Spillpoint(264, 129688, 129236, 5.1194), Spillpoint(338, 138570, 139022, 19.647), Spillpoint(101, 58108, 58558, 6.7165), Spillpoint(876, 261659, 262109, 2.5455), Spillpoint(245, 137214, 136762, 19.654), Spillpoint(260, 131499, 131049, 5.1203), Spillpoint(792, 249963, 249513, 2.5764), Spillpoint(-183, 52280, 52731, 6.721), Spillpoint(879, 263907, 264357, 2.5931), Spillpoint(873, 264806, 265256, 2.6536)], [0.15759999999999952, 0.01899999999999835, 0.04399999999999693, 0.04630000000000045, 0.04200000000000159, 1.1318000000000001, 0.1871000000000005, 0.13719999999999977, 0.2009999999999934, 0.0  …  4.020999999999961, 23.639999999999706, 120.73149999999991, 11.514600000000007, 25.008999999999986, 4.166600000000044, 13.898600000000002, 122.85570000000013, 15.211200000000012, 20.7984], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  3.991800000000029, 22.356000000000098, 117.4655999999999, 8.557000000000006, 23.645999999999706, 4.03339999999996, 11.785000000000007, 120.9713999999999, 13.929200000000002, 15.247000000000012], [[83046, 83047, 83048], [51885], [22595, 22596], [80345, 80346], [25778], [81711, 81712, 81713, 81714, 81715, 81716, 82163, 82164, 82165, 82166, 82167, 82168, 82618, 82619], [83985, 84436, 84437, 84888], [86709, 86710, 87161, 87162], [19498, 19948, 19949], [19054]  …  [129688, 130140, 130141, 130593, 130594, 131044, 131045, 131046, 131047, 131495  …  137823, 137824, 137825, 137826, 138274, 138275, 138276, 138277, 138278, 138729], [137215, 137216, 137664, 137665, 137667, 137668, 137669, 138112, 138113, 138114  …  144429, 144430, 144873, 144874, 144875, 144876, 144877, 144878, 144879, 144880], [45072, 45073, 45074, 45075, 45076, 45077, 45078, 45081, 45498, 45499  …  57214, 57659, 57660, 57661, 57662, 57663, 58108, 58109, 58110, 58111], [250412, 250413, 250862, 250863, 251312, 251313, 251762, 251763, 251764, 252212  …  259410, 259860, 260309, 260310, 260759, 260760, 261209, 261210, 261659, 261660], [137214, 137215, 137216, 137664, 137665, 137666, 137667, 137668, 137669, 138112  …  144430, 144873, 144874, 144875, 144876, 144877, 144878, 144879, 144880, 145329], [129236, 129688, 130140, 130141, 130593, 130594, 131044, 131045, 131046, 131047  …  137823, 137824, 137825, 137826, 138274, 138275, 138276, 138277, 138278, 138729], [249963, 250412, 250413, 250862, 250863, 251312, 251313, 251314, 251762, 251763  …  261659, 261660, 262109, 262558, 262559, 263008, 263009, 263458, 263459, 263908], [45072, 45073, 45074, 45075, 45076, 45077, 45078, 45079, 45081, 45498  …  58109, 58110, 58111, 58555, 58556, 58557, 58558, 59004, 59005, 59006], [248163, 248613, 249063, 249513, 249963, 250412, 250413, 250862, 250863, 251312  …  261660, 262109, 262558, 262559, 263008, 263009, 263458, 263459, 263907, 263908], [246813, 247263, 247713, 248163, 248613, 249063, 249512, 249513, 249962, 249963  …  263009, 263458, 263459, 263907, 263908, 263909, 264356, 264357, 264358, 264806]], [[1], [2], [3], [4], [5], [6], [7], [8], [9], [10]  …  [270, 293, 272, 284, 304, 307, 312, 311, 317, 324, 305], [325, 329, 369, 345, 342, 328, 332, 357, 364, 349], [99, 96, 85, 65, 59, 28, 87, 90, 36, 86, 106, 105, 104, 102, 103, 112], [870, 855, 864, 837, 847, 834, 825, 867, 860], [325, 329, 369, 345, 342, 328, 332, 357, 364, 349, 338], [270, 293, 272, 284, 304, 307, 312, 311, 317, 324, 305, 264], [872, 876, 870, 855, 864, 837, 847, 834, 825, 867, 860], [99, 96, 85, 65, 59, 28, 87, 90, 36, 86, 106, 105, 104, 102, 103, 112, 100, 101], [872, 876, 870, 855, 864, 837, 847, 834, 825, 867, 860, 792], [872, 876, 870, 855, 864, 837, 847, 834, 825, 867, 860, 792, 879]], [[1], [2], [3], [4], [5], [6], [7], [8], [9], [10]  …  [886], [887], [888], [889], [890, 990], [891, 992], [892, 992], [893], [894], [895]], Graphs.SimpleGraphs.SimpleDiGraph{Int64}(366, [Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[]  …  [1074], [1073], [1076], [1075], Int64[], Int64[], [1077], Int64[], [1078], Int64[]], [Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[], Int64[]  …  [270, 1065], [933, 1067], [99, 1066], [860, 1068], [338, 1070], [264, 1069], [989, 1072], [905, 1071], [792, 1075], [879, 1077]]), nothing, [(448, 113), (451, 113), (442, 114), (443, 114), (444, 114), (447, 114), (448, 114), (449, 114), (450, 114), (451, 114)  …  (161, 601), (162, 601), (163, 601), (164, 601), (165, 601), (166, 601), (167, 601), (168, 601), (169, 601), (170, 601)])</code></pre><p>The result of this analysis no longer indicate a large lake in this region:</p><pre><code class="language-julia hljs">tex = show_region_selection(tstruct,
                            region_color=4,
                            river_color=2,
                            trap_color=2);
tex[tex.==0] .= cmap[:green]-1
tex[isflat] .= cmap[:blue]

drape_surface(sf, tex)
set_camerapos(sc, view1...)</code></pre><img src="96780308.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>The data used in this example was originally obtained from <a href="https://kartverket.no/">Kartverket</a> (the Norwegian Mapping Authority) under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> license.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../synthetic/">« Simple synthetic example</a><a class="docs-footer-nextpage" href="../static/">Static analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Thursday 20 March 2025 22:57">Thursday 20 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
